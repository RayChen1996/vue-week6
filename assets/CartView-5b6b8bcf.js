import{S as g}from"./sweetalert2.all-742031dd.js";import{_ as m,o as c,c as r,a as t,F as p,f as _,g as f,t as l,h as C,v as x,d as I}from"./index-0c63a78b.js";const{VITE_URL:i,VITE_PATH:h}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"raychen",BASE_URL:"/vue-week6/",MODE:"production",DEV:!1,PROD:!0},v={data(){return{productID:"",cart:{},loadingItem:""}},methods:{getCarts(){this.$http.get(`${i}/v2/api/${h}/cart`).then(e=>{this.cart=e.data.data}).catch(e=>{alert(e.response.data.message)})},updateCart(e){this.loadingItem=e.id;const o={product_id:e.product.id,qty:e.qty};this.$http.put(`${i}/v2/api/${h}/cart/${e.id}`,{data:o}).then(d=>{this.showAlert(d.data.message),this.getCarts(),this.loadingItem=""}).catch(d=>{alert(d.response.data.message)})},showAlert(e){g.fire({position:"top-end",icon:"success",title:`${e}`,showConfirmButton:!1,timer:1500})},deleteCartItem(e){this.loadingItem=e.id,this.$http.delete(`${i}/v2/api/${h}/cart/${e.id}`).then(o=>{this.showAlert(o.data.message),this.loadingItem="",this.getCarts()}).catch(o=>{alert(o.response.data.message)})}},mounted(){this.getCarts()}},b={class:"table align-middle"},y=t("thead",null,[t("tr",null,[t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價"),t("th",null,"移除")])],-1),V={class:"input-group input-group-sm"},$=["onUpdate:modelValue","disabled","onChange"],w=["value"],k={class:"text-end"},E=["onClick","disabled"],T=t("i",{class:"fas fa-spinner fa-pulse"},null,-1),A=t("td",{colspan:"3",class:"text-end"},"總計",-1),D={class:"text-end"},B=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),S={class:"text-end text-success"};function U(e,o,d,q,n,u){return c(),r("table",b,[y,t("tbody",null,[n.cart.carts?(c(!0),r(p,{key:0},_(n.cart.carts,s=>(c(),r("tr",{key:s.id},[t("td",null,l(s.product.title),1),t("td",null,[t("div",V,[C(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":a=>s.qty=a,disabled:s.id===n.loadingItem,onChange:a=>u.updateCart(s)},[(c(),r(p,null,_(10,a=>t("option",{value:a,key:`${a}12`},l(a),9,w)),64))],40,$),[[x,s.qty]])])]),t("td",k,l(s.total),1),t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:a=>u.deleteCartItem(s),disabled:s.id===n.loadingItem},[T,I(" x ")],8,E)])]))),128)):f("",!0)]),t("tfoot",null,[t("tr",null,[A,t("td",D,l(n.cart.total),1)]),t("tr",null,[B,t("td",S,l(n.cart.final_total),1)])])])}const N=m(v,[["render",U]]);export{N as default};
